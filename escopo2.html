<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Emiss√µes GEE - Escopo 2</title>
    <style>
        /* Estilos CSS permanecem os mesmos */
        body { font-family: sans-serif; line-height: 1.6; margin: 20px; background-color: #1e1e1e; color: #d4d4d4; }
        .container { max-width: 600px; margin: auto; padding: 20px; background-color: #252526; border: 1px solid #3c3c3c; border-radius: 10px; }
        h1 { color: #4e94d8; text-align: center;}
        .form-group { margin-bottom: 15px; }
        .form-row { display: flex; gap: 10px; }
        .form-row .form-group { flex: 1; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="number"], select, button { padding: 10px; border-radius: 5px; border: 1px solid #3c3c3c; width: 100%; box-sizing: border-box; background-color: #3c3c3c; color: #d4d4d4; }
        input[readonly] { background-color: #2a2a2a; cursor: not-allowed; opacity: 0.7; }
        button { background-color: #0e639c; color: white; cursor: pointer; font-weight: bold; margin-top: 15px; }
        button:hover { background-color: #1b7ec3; }
        .resultado { margin-top: 20px; padding: 15px; background-color: #2c3e50; border: 1px solid #34495e; border-radius: 5px; display: none; }
        .demonstracao-calculo { background-color: rgba(0,0,0,0.2); padding: 10px; border-radius: 5px; font-family: monospace; text-align: left; margin-bottom: 15px; font-size: 0.9em; line-height: 1.5; }
        .demonstracao-calculo .calc-title { text-align: center; font-weight: bold; font-size: 1.2em; margin-bottom: 10px; display: block; }
        .demonstracao-calculo .calc-center { text-align: center; }
        strong { color: #569cd6; }
        footer { text-align: center; margin-top: 30px; font-size: 0.9em; color: #888; }
        .navegacao { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 30px; margin-top: 15px; }
        .botao-nav { padding: 8px 18px; border: 1px solid #555; border-radius: 20px; color: #d4d4d4; text-decoration: none; transition: all 0.3s ease; }
        .botao-nav:hover { background-color: #4e94d8; border-color: #4e94d8; color: #ffffff; }
        .info-label { font-size: 0.8em; color: #aaa; margin-top: 5px;}
        fieldset { border: 1px solid #3c3c3c; border-radius: 5px; padding: 15px; margin-bottom: 15px; }
        legend { color: #4e94d8; font-weight: bold; padding: 0 10px; }
        #areaComparativo ul { list-style: none; padding-left: 0; }
        #areaComparativo li { margin-bottom: 12px; font-size: 1.05em; }

        /* NOVO ESTILO PARA A TRADU√á√ÉO (DISCRETO) */
        .lang-en {
            font-size: 0.85em;
            color: #888; /* Cor mais apagada */
            font-weight: normal;
            font-style: italic;
            margin-left: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Calculadora de Emiss√µes de Gases do Efeito Estufa (Escopo 2) <br><span class="lang-en" style="font-size: 0.6em;">(GHG Emissions Calculator - Scope 2)</span></h1>
        <p><strong>Escopo 2:</strong> S√£o as emiss√µes da eletricidade que voc√™ compra e consome. <span class="lang-en">(Emissions from purchased electricity)</span><br>(geradas na usina de energia)<br><br><br>
        Pegue sua conta de luz, e veja quantos kWh (quilowatt-hora) voc√™ gastou para saber quanto voc√™ emitiu na atmosfera.<br><br>
        Preencha as datas de in√≠cio e fim de consumo para calcular a emiss√£o para qualquer per√≠odo. <span class="lang-en">(Fill in the dates to calculate emissions for any period)</span>
        </p>

        <form id="calculadoraForm">
            <fieldset>
                <legend>Data de In√≠cio do Per√≠odo de Refer√™ncia <span class="lang-en">(Start Date)</span></legend>
                 <div class="form-row">
                    <div class="form-group" style="flex: 1;">
                        <label for="dia_anterior">Dia <span class="lang-en">(Day)</span></label>
                        <input type="number" id="dia_anterior" min="1" max="31" required>
                    </div>
                    <div class="form-group" style="flex: 2;">
                         <label for="mes_anterior">M√™s <span class="lang-en">(Month)</span></label>
                        <select id="mes_anterior" required>
                            <option value="1">01 - Janeiro (Jan)</option>
                            <option value="2">02 - Fevereiro (Feb)</option>
                            <option value="3">03 - Mar√ßo (Mar)</option>
                            <option value="4">04 - Abril (Apr)</option>
                            <option value="5">05 - Maio (May)</option>
                            <option value="6">06 - Junho (Jun)</option>
                            <option value="7">07 - Julho (Jul)</option>
                            <option value="8">08 - Agosto (Aug)</option>
                            <option value="9">09 - Setembro (Sep)</option>
                            <option value="10">10 - Outubro (Oct)</option>
                            <option value="11">11 - Novembro (Nov)</option>
                            <option value="12">12 - Dezembro (Dec)</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex: 1.5;">
                         <label for="ano_anterior">Ano <span class="lang-en">(Year)</span></label>
                        <select id="ano_anterior" required>
                            <option value="">Carregando... (Loading...)</option>
                        </select>
                    </div>
                </div>
            </fieldset>

             <fieldset>
                <legend>Data de Fim do Per√≠odo de Refer√™ncia <span class="lang-en">(End Date)</span></legend>
                 <div class="form-row">
                    <div class="form-group" style="flex: 1;">
                        <label for="dia_atual">Dia <span class="lang-en">(Day)</span></label>
                        <input type="number" id="dia_atual" min="1" max="31" required>
                    </div>
                    <div class="form-group" style="flex: 2;">
                         <label for="mes_atual">M√™s <span class="lang-en">(Month)</span></label>
                        <select id="mes_atual" required>
                            <option value="1">01 - Janeiro (Jan)</option>
                            <option value="2">02 - Fevereiro (Feb)</option>
                            <option value="3">03 - Mar√ßo (Mar)</option>
                            <option value="4">04 - Abril (Apr)</option>
                            <option value="5">05 - Maio (May)</option>
                            <option value="6">06 - Junho (Jun)</option>
                            <option value="7">07 - Julho (Jul)</option>
                            <option value="8">08 - Agosto (Aug)</option>
                            <option value="9">09 - Setembro (Sep)</option>
                            <option value="10">10 - Outubro (Oct)</option>
                            <option value="11">11 - Novembro (Nov)</option>
                            <option value="12">12 - Dezembro (Dec)</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex: 1.5;">
                         <label for="ano_atual">Ano <span class="lang-en">(Year)</span></label>
                        <select id="ano_atual" required>
                            <option value="">Carregando... (Loading...)</option>
                        </select>
                    </div>
                </div><p style="font-style: italic; font-size: 0.9em; text-align: right;" id="statusData">Verificando dados... <span class="lang-en">(Checking data...)</span></p>
            </fieldset>

            <div class="form-group">
                <label for="consumo_kwh">Consumo Total de Energia no Per√≠odo (em kWh): <span class="lang-en">(Total Energy Consumption in kWh)</span></label>
                <input type="number" id="consumo_kwh" step="0.01" min="0" required>
            </div>

            <div class="form-group">
                <label for="fator_emissao">Fator de Emiss√£o Ponderado (tCO‚ÇÇe/MWh): <span class="lang-en">(Weighted Emission Factor)</span></label>
                <input type="number" id="fator_emissao" step="0.000001" min="0" readonly required>
                 <p class="info-label">Calculado automaticamente com base no per√≠odo selecionado. <span class="lang-en">(Auto-calculated based on selected period)</span></p>
            </div>

            <button type="submit">Calcular Emiss√£o <span class="lang-en">(Calculate)</span></button>
        </form>

        <div class="resultado" id="areaResultado">
            <h2>Resultado da Emiss√£o: <span class="lang-en">(Result)</span></h2>
            <p id="textoResultado"></p>
            <p id="mediaDiariaResultado"></p>
            <div id="demonstracaoCalculo"></div>
        </div>

        <div class="resultado" id="areaComparativo" style="background-color: #1c2b3a;">
        </div>

        

        <div class="navegacao">
             <a href="https://lagando.github.io/calculoGEE/escopo1.html" class="botao-nav">Escopo 1</a>
             <a href="https://lagando.github.io/calculoGEE/escopo2.html" class="botao-nav">Escopo 2</a>
             <a href="https://lagando.github.io/calculoGEE/escopo3.html" class="botao-nav">Escopo 3</a>
             <a href="https://lagando.github.io/calculoGEE/evitadas.html" class="botao-nav">Emiss√µes Evitadas</a>
        </div>
        <footer>
            <p><strong>O que √© tCO‚ÇÇe?</strong> <span class="lang-en">(What is tCO‚ÇÇe?)</span><br><br>
            tCO‚ÇÇe (tonelada de CO‚ÇÇ equivalente) √© a unidade de medida padr√£o que converte o impacto de aquecimento de todos os diferentes gases de efeito estufa em um √∫nico valor, como se tudo fosse di√≥xido de carbono.
            <br><br>
<strong>E por que usar ele?</strong> <span class="lang-en">(Why use it?)</span>
            <br>
N√≥s o usamos como base porque, como cada g√°s esquenta o planeta com uma "for√ßa" diferente, essa unidade nos permite somar todos eles em um resultado final √∫nico e f√°cil de comparar.</p>
            <p>Feito por Gabriel Bahia - gabrielbahiapro@gmail.com<br><br>
            <a href="https://www.linkedin.com/in/gabrielbahiagb/" target="_blank" style="color: #0077B5; font-weight: bold; text-decoration: underline; cursor: pointer;">- LinkedIn do pai (eu /gabrielbahiagb) -</a><br><br>
            Atualizado em: 24/01/2026 - v5</p>
        </footer>
    </div>

    <script>
        // --- DADOS DO JSON ---
        // Vari√°vel vazia para receber os dados externos
        let fatoresEmissao = {};

        // --- L√ìGICA JAVASCRIPT ---

        const [diaAnterior, mesAnterior, anoAnterior] = [document.getElementById('dia_anterior'), document.getElementById('mes_anterior'), document.getElementById('ano_anterior')];
        const [diaAtual, mesAtual, anoAtual] = [document.getElementById('dia_atual'), document.getElementById('mes_atual'), document.getElementById('ano_atual')];
        const campoConsumo = document.getElementById('consumo_kwh');
        const campoFator = document.getElementById('fator_emissao');
        const formulario = document.getElementById('calculadoraForm');
        const areaResultado = document.getElementById('areaResultado');
        const textoResultado = document.getElementById('textoResultado');
        const mediaDiariaResultado = document.getElementById('mediaDiariaResultado');
        const demonstracaoCalculo = document.getElementById('demonstracaoCalculo');
        const areaComparativo = document.getElementById('areaComparativo');
        const statusData = document.getElementById('statusData');

        const formatNumber = (num, decimals) => num.toLocaleString('pt-BR', { minimumFractionDigits: decimals, maximumFractionDigits: decimals });

        // --- FUN√á√ÉO PARA CARREGAR JSON EXTERNO ---
        async function carregarFatoresExternos() {
            try {
                // Adiciona timestamp para evitar cache e garantir dados frescos
                const timestamp = new Date().getTime();
                const response = await fetch(`https://lagando.github.io/calculoGEE/fatores.json?t=${timestamp}`);
                
                if (!response.ok) throw new Error('Erro na rede ao tentar carregar o arquivo JSON.');
                
                fatoresEmissao = await response.json();
                
                // Ap√≥s carregar, inicializa o formul√°rio com os dados novos
                inicializarFormulario();
            } catch (error) {
                console.error("Erro ao carregar fatores de emiss√£o:", error);
                statusData.textContent = "Erro ao carregar dados de emiss√£o. Verifique a conex√£o.";
                statusData.style.color = "red";
            }
        }

        function calcularFatorPonderado() {
            // Se os fatores ainda n√£o carregaram, n√£o faz nada
            if (Object.keys(fatoresEmissao).length === 0) return null;

            const dataInicio = new Date(parseInt(anoAnterior.value), parseInt(mesAnterior.value) - 1, parseInt(diaAnterior.value));
            const dataFim = new Date(parseInt(anoAtual.value), parseInt(mesAtual.value) - 1, parseInt(diaAtual.value));

            // Zera horas para evitar problemas de fuso hor√°rio
            dataInicio.setHours(0,0,0,0);
            dataFim.setHours(0,0,0,0);

            if (isNaN(dataInicio) || isNaN(dataFim) || dataFim < dataInicio) {
                campoFator.value = '';
                campoFator.placeholder = 'Per√≠odo inv√°lido (Invalid)';
                return null;
            }

            let totalDias = 0;
            let somaPonderada = 0;
            const breakdown = [];
            // Clona a data para n√£o alterar a original durante o loop
            let dataCorrente = new Date(dataInicio);
            dataCorrente.setHours(0,0,0,0);

            while(dataCorrente <= dataFim){
                const ano = dataCorrente.getFullYear();
                const mes = dataCorrente.getMonth() + 1;

                const fatorDoMes = fatoresEmissao[ano]?.[mes];
                if(fatorDoMes === undefined){
                    campoFator.value = '';
                    campoFator.placeholder = `Fator para ${mes}/${ano} n√£o encontrado`;
                    return null;
                }

                let diasNesteMes = 0;
                const ultimoDiaDoMes = new Date(ano, mes, 0).getDate();

                // L√≥gica refinada para contar os dias (In√≠cio, Meio, Fim)
                const isMesInicio = (ano === dataInicio.getFullYear() && (mes - 1) === dataInicio.getMonth());
                const isMesFim = (ano === dataFim.getFullYear() && (mes - 1) === dataFim.getMonth());

                if (isMesInicio && isMesFim) {
                    // Per√≠odo come√ßa e termina no mesmo m√™s
                    diasNesteMes = dataFim.getDate() - dataInicio.getDate() + 1;
                } else if (isMesInicio) {
                    // Primeiro m√™s (pode ser parcial)
                    diasNesteMes = ultimoDiaDoMes - dataInicio.getDate() + 1;
                } else if (isMesFim) {
                    // √öltimo m√™s (pode ser parcial)
                    diasNesteMes = dataFim.getDate();
                } else {
                    // M√™s completo no meio do per√≠odo
                    diasNesteMes = ultimoDiaDoMes;
                }

                somaPonderada += diasNesteMes * fatorDoMes;
                totalDias += diasNesteMes;
                breakdown.push({ ano, mes, dias: diasNesteMes, fator: fatorDoMes });

                // --- CORRE√á√ÉO DO LOOP ---
                // 1. Seta dia 1 do m√™s corrente para evitar pular meses de 28/30 dias
                dataCorrente.setDate(1); 
                // 2. Avan√ßa para o pr√≥ximo m√™s
                dataCorrente.setMonth(dataCorrente.getMonth() + 1);
            }

            if (totalDias === 0) return null;

            const fatorFinalPonderado = somaPonderada / totalDias;
            campoFator.value = fatorFinalPonderado.toFixed(8);

            return { fatorPonderado: fatorFinalPonderado, totalDias, breakdown };
        }

        function inicializarFormulario() {
            const anosDisponiveis = Object.keys(fatoresEmissao).map(Number);
            
            if (anosDisponiveis.length === 0) return;

            const ultimoAnoDisponivel = Math.max(...anosDisponiveis);
            const mesesDoUltimoAno = Object.keys(fatoresEmissao[ultimoAnoDisponivel]).map(Number);
            const ultimoMesDisponivel = Math.max(...mesesDoUltimoAno);
            const anoInicial = Math.min(...anosDisponiveis);
            const selectsAno = [anoAnterior, anoAtual];
            
            // Atualiza status visual
            const nomeMes = new Date(ultimoAnoDisponivel, ultimoMesDisponivel - 1, 1).toLocaleString('pt-BR', { month: 'long' });
            statusData.innerHTML = `(calculo dispon√≠vel at√© ${nomeMes}/${ultimoAnoDisponivel}) <span class="lang-en" style="font-size: 0.8em;">(Data available until ${ultimoMesDisponivel}/${ultimoAnoDisponivel})</span>`;
            statusData.style.color = "#d4d4d4";

            selectsAno.forEach(select => {
                select.innerHTML = '';
                for (let ano = ultimoAnoDisponivel; ano >= anoInicial; ano--) {
                    const option = document.createElement('option');
                    option.value = ano;
                    option.textContent = ano;
                    select.appendChild(option);
                }
            });
            let [mA, aA] = [ultimoMesDisponivel, ultimoAnoDisponivel];
            mesAtual.value = mA;
            anoAtual.value = aA;
            let [mP, aP] = [mA - 1, aA];
            if (mP === 0) {
                mP = 12;
                aP = aP - 1;
            }
            mesAnterior.value = mP;
            anoAnterior.value = aP;
            diaAnterior.value = 1;
            diaAtual.value = new Date(aA, mA, 0).getDate();
            calcularFatorPonderado();
        }

        function formatarEquivalencia(valor) {
            if (valor < 0.01 && valor > 0) {
                return 'menos de 0,01';
            }
            if (valor >= 10 || valor === 0) {
                return formatNumber(valor, 0); 
            }
            if (valor >= 1) {
                return formatNumber(valor, 1); 
            }
            return formatNumber(valor, 2); 
        }

        function calcularEmissao(event) {
            event.preventDefault();
            const dadosCalculo = calcularFatorPonderado();
            const consumo_kwh = parseFloat(campoConsumo.value);

            if (!dadosCalculo || isNaN(consumo_kwh) || consumo_kwh <= 0) {
                alert('Verifique os dados. Preencha o per√≠odo e o consumo com valores v√°lidos.');
                areaResultado.style.display = 'none';
                areaComparativo.style.display = 'none';
                return;
            }

            const fator_usado = parseFloat(campoFator.value);
            const consumo_mwh = consumo_kwh / 1000;
            const emissao_tco2e = consumo_mwh * fator_usado;
            const mediaDiaria = emissao_tco2e / dadosCalculo.totalDias;

            const [dAnt, mAnt, aAnt] = [String(diaAnterior.value).padStart(2, '0'), String(mesAnterior.value).padStart(2, '0'), anoAnterior.value];
            const [dAtu, mAtu, aAtu] = [String(diaAtual.value).padStart(2, '0'), String(mesAtual.value).padStart(2, '0'), anoAtual.value];

            //textoResultado.innerHTML = `Para o per√≠odo de <strong>${dAnt}/${mAnt}/${aAnt}</strong> a <strong>${dAtu}/${mAtu}/${aAtu}</strong>, a emiss√£o total foi de <strong>${formatNumber(emissao_tco2e, 6)} tCO‚ÇÇe</strong>. <br><span class="lang-en" style="display:block; margin-top:5px;">(For this period, total emission was <strong>${formatNumber(emissao_tco2e, 6)} tCO‚ÇÇe</strong>)</span>`;
            textoResultado.innerHTML = `
  <div style="text-align: center; margin-bottom: 10px;">
    <span style="font-size: 1rem;">Para o per√≠odo de <strong>${dAnt}/${mAnt}/${aAnt}</strong> a <strong>${dAtu}/${mAtu}/${aAtu}</strong>, a emiss√£o total foi de:</span>
    
    <div style="font-size: 2.8rem; font-weight: bold; margin: 15px 0; line-height: 1;">
      ${formatNumber(emissao_tco2e, 6)} tCO‚ÇÇe
    </div>

    <span class="lang-en" style="display:block; font-size: 0.9rem; opacity: 0.8; margin-top: 5px;">
      (Total emission for this period)
    </span>
  </div>
`;
            mediaDiariaResultado.innerHTML = `Isto representa uma m√©dia de <strong>${formatNumber(mediaDiaria, 8)} tCO‚ÇÇe por dia</strong>. <span class="lang-en">(Daily average)</span>`;

            let breakdownHtml = dadosCalculo.breakdown.map(item =>
                `&nbsp;${String(item.mes).padStart(2,'0')}/${item.ano}: ${String(item.dias).padStart(2,' ')} dias &times; ${formatNumber(item.fator, 5)}`
            ).join('<br>');
            let demoHtml = `<div class="demonstracao-calculo">
                    <span class="calc-title">Composi√ß√£o do Fator Ponderado <span class="lang-en" style="font-size:0.7em">(Factor Breakdown)</span></span>
                    ${breakdownHtml}
                    <hr>
                    Total: ${dadosCalculo.totalDias} dias

                    <strong>Fator Final: ${formatNumber(dadosCalculo.fatorPonderado, 8)} tCO‚ÇÇe/MWh</strong>
                </div>`;
            demoHtml += `<div class="demonstracao-calculo calc-center">
                <span class="calc-title">C√°lculo da Emiss√£o Final <span class="lang-en" style="font-size:0.7em">(Final Calculation)</span></span>
                (${formatNumber(consumo_kwh, 2)} kWh / 1000) &times; ${formatNumber(fator_usado, 8)}

                = <strong>${formatNumber(emissao_tco2e, 6)} tCO‚ÇÇe</strong>
            </div>`;
            demonstracaoCalculo.innerHTML = demoHtml;


            // --- SE√á√ÉO DE COMPARA√á√ÉO ---
            const TCO2E_POR_KM_CARRO_GASOLINA = 0.00025;
            const TCO2E_SEQUESTRADO_POR_ARVORE_ANO = 0.022;
            const TCO2E_POR_CARGA_SMARTPHONE = 0.0000084;
            const TCO2E_POR_HORA_STREAMING_HD = 0.00005;
            const TCO2E_POR_KG_CARNE_BOVINA = 0.060;
            const TCO2E_POR_VOO_RIO_SP = 0.06;
            const TCO2E_POR_M2_DESMATAMENTO_AMAZONIA = 0.066;
            const TCO2E_POR_BARRIL_PETROLEO = 0.43;
            const TCO2E_POR_LATA_ALUMINIO = 0.00013;
            const KWH_MEDIO_CASA_MES = 160;
            const KWH_GERADO_M2_PAINEL_SOLAR_MES = 220 / 12;
            const MWH_POR_HORA_AR_CONDICIONADO = 0.0009;
            const MWH_POR_BANHO_ELETRICO_10MIN = 0.00092;
            const consumo_mwh_total = consumo_kwh / 1000;
            const TCO2E_EVITADO_LATA_ALUMINIO = 0.000126;
            const TCO2E_EVITADO_GARRAFA_PET = 0.000022;
            const TCO2E_EVITADO_KG_PAPEL = 0.003;
            const TCO2E_EVITADO_KG_ORGANICO_COMPOSTADO = 0.0006;

            const kmDeCarro = emissao_tco2e / TCO2E_POR_KM_CARRO_GASOLINA;
            const arvoresPorAno = emissao_tco2e / TCO2E_SEQUESTRADO_POR_ARVORE_ANO;
            const cargasDeSmartphone = emissao_tco2e / TCO2E_POR_CARGA_SMARTPHONE;
            const horasDeStreaming = emissao_tco2e / TCO2E_POR_HORA_STREAMING_HD;
            const kgDeCarne = emissao_tco2e / TCO2E_POR_KG_CARNE_BOVINA;
            const voosRioSP = emissao_tco2e / TCO2E_POR_VOO_RIO_SP;
            const m2Desmatados = emissao_tco2e / TCO2E_POR_M2_DESMATAMENTO_AMAZONIA;
            const camposDeFutebol = m2Desmatados / 7140;
            const barrisDePetroleo = emissao_tco2e / TCO2E_POR_BARRIL_PETROLEO;
            const latasDeAluminio = emissao_tco2e / TCO2E_POR_LATA_ALUMINIO;
            const casasAbastecidasMes = consumo_kwh / KWH_MEDIO_CASA_MES;
            const m2PaineisSolaresNecessarios = consumo_kwh / KWH_GERADO_M2_PAINEL_SOLAR_MES;
            const horasDeArCondicionado = consumo_mwh_total / MWH_POR_HORA_AR_CONDICIONADO;
            const banhosDeChuveiro = consumo_mwh_total / MWH_POR_BANHO_ELETRICO_10MIN;
            const latasAluminioRecicladas = emissao_tco2e / TCO2E_EVITADO_LATA_ALUMINIO;
            const garrafasPetRecicladas = emissao_tco2e / TCO2E_EVITADO_GARRAFA_PET;
            const kgPapelReciclado = emissao_tco2e / TCO2E_EVITADO_KG_PAPEL;
            const kgOrganicoCompostado = emissao_tco2e / TCO2E_EVITADO_KG_ORGANICO_COMPOSTADO;

            const comparativoHtml = `<br>
                <h3 style="text-align:center; color: #569cd6; margin-bottom: 20px;">O total emitido neste per√≠odo equivale a: <br><span class="lang-en" style="font-size:0.7em">(Equivalent to:)</span></h3><br>

                <h4 style="color: #4e94d8; border-bottom: 1px solid #444; padding-bottom: 5px;">üè† No dia a dia... <span class="lang-en">(Daily Life)</span></h4>
                <ul>
                    <li>üöø <strong>${formatarEquivalencia(banhosDeChuveiro)}</strong> banhos de 10 minutos em um chuveiro el√©trico. <span class="lang-en">(Showers)</span></li>
                    <li>‚ùÑÔ∏è Manter um ar condicionado ligado por <strong>${formatarEquivalencia(horasDeArCondicionado)}</strong> horas. <span class="lang-en">(AC hours)</span></li>
                    <li>üì± Carregar completamente um smartphone <strong>${formatarEquivalencia(cargasDeSmartphone)}</strong> vezes. <span class="lang-en">(Phone charges)</span></li>
                    <li>üì∫ Assistir a <strong>${formatarEquivalencia(horasDeStreaming)}</strong> horas de v√≠deo em alta defini√ß√£o. <span class="lang-en">(Streaming hours)</span></li>
                </ul>

                <h4 style="color: #4e94d8; border-bottom: 1px solid #444; padding-bottom: 5px; margin-top: 25px;">üí° Energia e Ind√∫stria... <span class="lang-en">(Energy & Industry)</span></h4>
                <ul>
                    <li>üè† A energia consumida por <strong>${formatarEquivalencia(casasAbastecidasMes)} resid√™ncias</strong> durante um m√™s. <span class="lang-en">(Houses powered/month)</span></li>
                    <li>‚òÄÔ∏è Seriam necess√°rios cerca de <strong>${formatarEquivalencia(m2PaineisSolaresNecessarios)} m¬≤</strong> de pain√©is solares para gerar essa mesma energia em um m√™s. <span class="lang-en">(Solar panels area)</span></li>
                    <li>üõ¢Ô∏è A queima de <strong>${formatarEquivalencia(barrisDePetroleo)} barris</strong> de petr√≥leo. <span class="lang-en">(Oil barrels)</span></li>
                    <li>ü•´ A produ√ß√£o de <strong>${formatarEquivalencia(latasDeAluminio)} latinhas</strong> de alum√≠nio. <span class="lang-en">(Aluminum cans produced)</span></li>
                </ul>

                <h4 style="color: #4e94d8; border-bottom: 1px solid #444; padding-bottom: 5px; margin-top: 25px;">üöó Transporte e Brasil... <span class="lang-en">(Transport & Environment)</span></h4>
                 <ul>
                    <li>üöó Dirigir um carro de passeio a gasolina por <strong>${formatarEquivalencia(kmDeCarro)} km</strong>. <span class="lang-en">(Km driven by car)</span></li>
                    <li>‚úàÔ∏è <strong>${formatarEquivalencia(voosRioSP)}</strong> voos (s√≥ de ida) na ponte a√©rea Rio-S√£o Paulo por passageiro. <span class="lang-en">(Flights)</span></li>
                    <li>üêÑ As emiss√µes da produ√ß√£o de <strong>${formatarEquivalencia(kgDeCarne)} kg</strong> de carne bovina. <span class="lang-en">(Beef production)</span></li>
                    <li>üå≥ O carbono que <strong>${formatarEquivalencia(arvoresPorAno)} √°rvores</strong> adultas absorvem da atmosfera em um ano. <span class="lang-en">(Trees absorbing/year)</span></li>
                    <li>üî• O desmatamento de <strong>${formatarEquivalencia(m2Desmatados)} m¬≤</strong> de floresta amaz√¥nica. <span class="lang-en">(Deforestation area)</span>
                        <br><small style="opacity: 0.8;"><i>(Equivalente a <strong>${formatarEquivalencia(camposDeFutebol)}</strong> campos de futebol) <span class="lang-en">(Soccer fields)</span></i></small>
                    </li>
                </ul>

                <h4 style="color: #4e94d8; border-bottom: 1px solid #444; padding-bottom: 5px; margin-top: 25px;">‚ôªÔ∏è Reciclagem e A√ß√µes Positivas <span class="lang-en">(Recycling)</span></h4>
                <p style="font-size:0.9em; opacity:0.8; margin-top:-10px; margin-bottom:15px;">Esta mesma quantidade de emiss√£o poderia ser <strong>evitada</strong> com a√ß√µes como: <span class="lang-en">(Equivalent avoided by:)</span></p>
                 <ul>
                    <li>ü•´ Reciclar <strong>${formatarEquivalencia(latasAluminioRecicladas)} latinhas</strong> de alum√≠nio. <span class="lang-en">(Recycling cans)</span></li>
                    <li>üçæ Reciclar <strong>${formatarEquivalencia(garrafasPetRecicladas)} garrafas PET</strong> de 500ml. <span class="lang-en">(Recycling PET bottles)</span></li>
                    <li>üì∞ Reciclar <strong>${formatarEquivalencia(kgPapelReciclado)} kg</strong> de papel e papel√£o. <span class="lang-en">(Recycling paper)</span></li>
                    <li>ü•ï Composter <strong>${formatarEquivalencia(kgOrganicoCompostado)} kg</strong> de res√≠duos org√¢nicos (evitando a gera√ß√£o de metano no aterro). <span class="lang-en">(Composting organic waste)</span></li>
                </ul>

                <p style="font-size: 0.8em; text-align: center; opacity: 0.7; margin-top:20px;"><i>* As equival√™ncias s√£o estimativas para fins ilustrativos, baseadas em m√©dias de fontes como EPA (incluindo o modelo WARM), IEA, INPE, EPE e Embrapa.</i></p>
            `;

            areaComparativo.innerHTML = comparativoHtml;
            areaResultado.style.display = 'block';
            areaComparativo.style.display = 'block';
        }

        // --- INICIALIZA√á√ÉO E EVENTOS ---

        // Alterado para carregar o JSON ao iniciar a p√°gina
        document.addEventListener('DOMContentLoaded', carregarFatoresExternos);

        [diaAnterior, mesAnterior, anoAnterior, diaAtual, mesAtual, anoAtual].forEach(campo => {
            campo.addEventListener('change', calcularFatorPonderado);
            campo.addEventListener('input', calcularFatorPonderado);
        });

        formulario.addEventListener('submit', calcularEmissao);
    </script>
</body>
</html>
